
# 1. Manifesto of the fight against unprotected s2s connections to protect users from intercepting plain-text messages

In the past, the certificates were worth the money. In the past, obtaining certificates was a difficult task. This forced the use of self-signed certificates in connections to preserve the federation. Invalid certificates are dangerous because unencrypted (without e2e) user communications can be intercepted and modified.

Currently, certificates have become free and anyone can get them. Unfortunately, 10% servers continue to use invalid encryption. We do not want to compromise with servers that do not care about user security. If they want to support connection us, they will make valid encryption.

We believe that the time has come to stop supporting untrusted certificates to increase user security.

Default settings Ejabberd and Prosody uses encryption but allow self-signed certificates:

**Ejabberd:**
```
mod_s2s_dialback: {}

```
**Prosody**
```
s2s_secure_auth = false
```
Most xmpp servers have valid certificates, but they allow non-valid encryption by default.

we are not the ones who talk about privacy, but at the same time allow to intercept correspondence. We think that our users should be confident that they use only secure connections. [Manual for operators XMPP servers](https://github.com/E-404/Manifestos/blob/master/1.md#setup-instructions)


## Servers in this list pledge not to accept connections with untrusted certificates.

+ [404.city](https://404.city)
  + [jabberon.ru](https://jabberon.ru)
+ [xmpp.is](https://xmpp.is)
  + xmpp.co
  + xmpp.cx
  + xmpp.xyz
  + xmpp.fi
  + xmpp.si  
+ [jabber.at](https://jabber.at)
  + xmpp.zone
+ [os.vu](https://os.vu)
+ [trashserver.net](https://trashserver.net)


## Servers in this list refused to support the manifest

Servers that fail to verify certificates in cross-server connections

## Servers violated the execution of the manifest

Servers that accepted the manifest, but did not use it


## Setup Instructions


### Warning! 
Many administrators are trying to upgrade the certificate class by manually listing the ciphers - this is wrong. **Leave the defaults s2s list ciphers alone**. To upgrade the certificate class, [use the ECC certificate](https://wiki.404.city/en/Acme.sh) instead of RSA, and not guessing with cipher list!


**Correct default (example for Ejabberd):**
```
'TLS_CIPHERS': "HIGH:!aNULL:!eNULL:!3DES:@STRENGTH"
```
**Wrong modification: (example for Ejabberd)**
 ```
 'TLS_CIPHERS': "ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-CAMELLIA256-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA"

```
This set includes **ECC (ECDHE-ECDSA) and RSA (ECDHE-RSA)** ciphers.If you do not include the ciphers in the ECC, you will lose contact with the ECC servers. If you do not enable RSA ciphers, you will lose connection with RSA servers. 

This is config right now, but will not work in the future! In the future, new ciphers will appear and the setting will be incorrect. 

### Configuration

**Ejabberd (ejabberd.yml)**

delete:
```
mod_s2s_dialback: {}
```
Change
```
s2s_use_starttls: required
```
to
```
s2s_use_starttls: required_trusted
```


**Prosody**

```
s2s_secure_auth = false
```
Change to
```
s2s_secure_auth = true
```
## Feedback

XMPP contact: 
```
support@404.city
```
Connection test. XMPP echo contact (sends back messages to [Gajim](https://gajim.org) ): 
```
echo.404.city
```
